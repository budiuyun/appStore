# hyperf

🔋 (PHP / Hyperf) 生产就绪的Docker镜像，带有自动Hyperf安装程序

## 应用介绍

本应用提供以下功能：
- 高性能PHP协程框架：基于Swoole扩展，性能远超传统PHP-FPM
- 自动安装Hyperf框架：快速启动新项目
- 完整的PHP开发环境：内置最新版Composer
- HTTPS支持：预生成SSL证书用于本地测试
- 环境变量配置：支持通过环境变量配置PHP和PHP-FPM

## 配置说明

| 参数 | 说明 | 默认值 |
|------|------|--------|
| 镜像标签 | Hyperf版本 | `latest` |
| 服务端口 | HTTP端口 | `80` |
| 服务端口 | HTTPS端口 | `443` |
| 资源限制 | CPU和内存限制 | 见下文 |
| 持久化存储 | 数据存储配置 | 见下文 |

### 资源配置
- CPU限制: 200m（相当于0.2核心）
- 内存限制: 256Mi（相当于256MB）
- CPU请求: 100m（相当于0.1核心）
- 内存请求: 128Mi（相当于128MB）

### 持久化存储配置
- 启用持久化: true（建议开启）
- 挂载路径: 
  - /var/www/html（应用代码目录）
  - /etc/ssl/site（SSL证书目录）
- 存储大小: 1Gi（可根据需求调整）
- 存储类: local（取决于集群环境）

## 数据存储

Hyperf应用的代码存储在容器的 `/var/www/html` 目录中。启用持久化存储后，代码和数据将保存在持久卷中，即使容器重启也不会丢失。

SSL证书存储在 `/etc/ssl/site` 目录中，包含:
- server.crt（证书文件）
- server.key（密钥文件）

**提示**：在生产环境中，请替换预生成的SSL证书为您自己的有效证书。

## 使用说明

1. 部署应用后，可通过以下方式访问服务：
   - HTTP：访问服务的80端口
   - HTTPS：访问服务的443端口

2. 创建新项目：
   - 当您将一个空目录挂载到容器的`/var/www/html`目录时，系统会自动下载Hyperf框架源码
   - 这将帮助您快速启动一个新项目

3. 使用现有项目：
   - 将已有的Hyperf项目代码挂载到容器的`/var/www/html`目录

## 环境变量配置

Hyperf支持多种环境变量配置，主要包括：

| 环境变量 | 描述 | 默认值 |
|---------|------|--------|
| APP_USER | 应用运行的用户名 | `www-data` |
| APP_GROUP | 应用运行的用户组 | `www-data` |
| PHP_VERSION | PHP运行版本 | `latest` |

## 安全注意事项

- 生产环境中请使用有效的SSL证书
- 定期更新Hyperf框架和依赖包
- 配置适当的网络策略限制访问
- 定期备份应用数据