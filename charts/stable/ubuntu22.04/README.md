# Ubuntu 22.04

带有SSH服务的Ubuntu镜像，支持远程管理，具有持久化存储功能，可以像虚拟机一样使用。

## 应用介绍

本应用提供以下功能：
- Ubuntu 22.04 LTS：稳定可靠的Linux操作系统
- 内置SSH服务：支持远程管理和操作
- 多路径持久化存储：确保数据安全
- 类虚拟机体验：可作为开发、测试或运行轻量级服务的环境

## 配置说明

| 参数 | 说明 | 默认值 |
|------|------|--------|
| 副本数量 | 部署的实例数量 | `1` |
| 工作负载类型 | 部署的Kubernetes工作负载类型 | `Deployment` |
| 镜像标签 | Ubuntu版本 | `22.04` |
| 服务类型 | Kubernetes服务类型 | `ClusterIP` |
| 资源限制 | CPU和内存限制 | 见下文 |
| 持久化存储 | 数据存储配置 | 见下文 |

### 资源配置
- CPU限制: 200m（相当于0.2核心）
- 内存限制: 250Mi（相当于250MB）
- CPU请求: 100m（相当于0.1核心）
- 内存请求: 100Mi（相当于100MB）

### 持久化存储配置
- 启用持久化: true（建议开启）
- 存储大小: 10Gi（可根据需求调整）
- 存储类: local（取决于集群环境）
- 访问模式: ReadWriteOnce

### 环境变量配置

| 变量名 | 说明 | 默认值 |
|--------|------|--------|
| ROOT_PASSWORD | SSH登录的root用户密码 | `budiu123` |
| TZ | 容器的时区设置 | `Asia/Shanghai` |

## 持久卷挂载说明

本Chart支持多路径持久卷挂载，使Ubuntu容器可以像虚拟机一样保存数据：

- /root：root用户主目录
- /home：普通用户主目录
- /etc：系统配置文件
- /var/lib：系统库文件
- /opt：可选应用程序
- /usr/local：本地安装的软件
- /var/log：系统日志
- /tmp：临时文件

持久化实现方式：
1. 初始化容器(initContainer)会检查每个挂载路径对应的持久卷是否为空
2. 如果为空，会将系统原始数据复制到持久卷中
3. 主容器使用subPath将持久卷的子目录挂载到对应的系统路径

## 使用说明

1. 部署应用后，可通过以下方式访问服务：
   - SSH：使用SSH客户端连接服务的22端口

2. 连接Ubuntu：
   ```
   ssh root@<服务IP> -p 22
   ```
   出现提示时输入ROOT_PASSWORD环境变量设置的值（默认为budiu123）

## 安全注意事项

- 生产环境中请修改默认的root密码
- 考虑使用更严格的网络访问控制
- 定期备份重要数据
- 配置适当的资源限制，防止资源滥用

## 故障排除

1. 无法通过SSH连接：
   - 检查服务是否正常运行
   - 验证用户名和密码是否正确
   - 确认网络连接是否畅通
   - 检查容器日志
2. 持久化问题：
   - 确认PVC已正确创建并绑定
   - 检查存储类是否可用
   - 验证存储容量是否足够

## 安装方法

```bash
helm install my-ubuntu ./ubuntu22.04
```