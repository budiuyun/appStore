# postgresql

PostgreSQL是一个开源的对象关系型数据库，以可靠性和数据完整性著称

## 应用介绍

本应用提供以下功能：
- 高性能关系型数据库：支持复杂查询、外键、触发器和存储过程
- ACID合规性：确保数据事务的原子性、一致性、隔离性和持久性
- 丰富的数据类型：支持JSON、JSONB、数组、地理信息等高级数据类型
- 强大的扩展系统：可通过扩展增加额外功能，如PostGIS地理信息扩展
- 高度可配置：通过环境变量轻松调整各种参数

## 配置说明

| 参数 | 说明 | 默认值 |
|------|------|--------|
| 镜像标签 | PostgreSQL版本 | `latest` |
| 服务端口 | 数据库服务端口 | `5432` |
| 资源限制 | CPU和内存限制 | 见下文 |
| 持久化存储 | 数据存储配置 | 见下文 |

### 资源配置
- CPU限制: 500m（相当于0.5核心）
- 内存限制: 1Gi（相当于1GB）
- CPU请求: 100m（相当于0.1核心）
- 内存请求: 256Mi（相当于256MB）

### 持久化存储配置
- 启用持久化: true（建议开启）
- 挂载路径: /bitnami/postgresql
- 存储大小: 8Gi（可根据需求调整）
- 存储类: local（取决于集群环境）

## 数据存储

PostgreSQL的数据存储在容器的 `/bitnami/postgresql` 目录中。启用持久化存储后，数据将保存在持久卷中，即使容器重启也不会丢失。

**提示**：请确保分配足够的存储空间，特别是如果您的数据库需要存储大量数据或处理大型事务日志。对于生产环境，建议至少8GB的存储空间。

## 使用说明

1. 部署应用后，可通过以下方式访问服务：
   - 数据库客户端：连接到服务的5432端口
   - 命令行：使用psql命令行工具连接

2. 首次启动时，系统将自动完成初始化：
   - 创建指定的初始数据库
   - 创建指定的数据库用户
   - 应用配置的环境变量设置

3. 数据库管理：
   - 使用标准SQL命令管理数据库
   - 支持创建多个数据库、表和用户
   - 可通过pgAdmin等工具进行图形化管理

## 环境变量配置

PostgreSQL支持多种环境变量配置，主要包括：

| 环境变量 | 描述 | 默认值 |
|---------|------|--------|
| POSTGRESQL_DATABASE | 要创建的初始数据库名称 | `postgres` |
| POSTGRESQL_USERNAME | 要创建的数据库用户名 | `postgres` |
| POSTGRESQL_PASSWORD | 数据库用户的密码 | `password` |
| POSTGRESQL_ALLOW_REMOTE_CONNECTIONS | 是否允许远程连接到数据库 | `yes` |
| POSTGRESQL_MAX_CONNECTIONS | 设置最大连接数 | `100` |
| POSTGRESQL_SHARED_PRELOAD_LIBRARIES | 预加载的PostgreSQL库列表 | `pgaudit` |

## 安全注意事项

- 生产环境中请设置强密码
- 限制数据库访问来源IP
- 考虑启用SSL/TLS加密连接
- 定期备份数据库内容
- 定期更新到最新的安全补丁版本