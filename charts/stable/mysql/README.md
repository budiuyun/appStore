# MySQL

官方MySQL数据库服务Chart，提供可靠的关系型数据库系统。

## 应用介绍

本应用提供以下功能：
- MySQL 8.0 数据库服务：稳定可靠的关系型数据库系统
- 支持持久化存储：确保数据安全
- 灵活配置：可自定义资源限制、存储大小等参数

## 配置说明

| 参数 | 说明 | 默认值 |
|------|------|--------|
| 镜像标签 | MySQL版本 | `8.0` |
| 服务端口 | MySQL服务端口 | `3306` |
| 资源限制 | CPU和内存限制 | 见下文 |
| 持久化存储 | 数据存储配置 | 见下文 |

### 资源配置
- CPU限制: 500m（相当于0.5核心）
- 内存限制: 1000Mi（相当于1GB）
- 临时存储限制: 2Gi（相当于2GB）
- CPU请求: 250m（相当于0.25核心）
- 内存请求: 512Mi（相当于512MB）
- 临时存储请求: 1Gi（相当于1GB）

### 持久化存储配置
- 启用持久化: true（建议开启）
- 挂载路径: /var/lib/mysql
- 存储大小: 5Gi（可根据需求调整）
- 存储类: local（取决于集群环境）

### 环境变量配置

| 变量名 | 说明 | 默认值 |
|--------|------|--------|
| MYSQL_ROOT_PASSWORD | MySQL根用户密码 | `root` |
| MYSQL_DATABASE | 自动创建的数据库名 | `mydb` |
| MYSQL_USER | 自动创建的普通用户名 | `user` |
| MYSQL_PASSWORD | 普通用户密码 | `password` |

## 数据存储

MySQL数据默认存储在容器的 `/var/lib/mysql` 目录中，您可以通过配置 `persistence.path` 参数来自定义这个路径。启用持久化存储后，数据将保存在持久卷中，即使容器重启也不会丢失。

**提示**：请确保分配足够的存储空间，生产环境建议至少 5Gi。

## 使用说明

1. 部署应用后，可通过以下方式访问服务：
   - MySQL：使用数据库客户端连接服务的3306端口

2. 连接MySQL：
   ```
   mysql -h <服务IP> -P 3306 -u root -p
   ```
   出现提示时输入MYSQL_ROOT_PASSWORD环境变量设置的值（默认为root）

3. 使用普通用户连接指定数据库：
   ```
   mysql -h <服务IP> -P 服务端口 -u user -p mydb
   ```
   出现提示时输入MYSQL_PASSWORD环境变量设置的值

## 安全注意事项

- 生产环境中请修改默认的root密码和普通用户密码
- 考虑使用更严格的网络访问控制
- 定期备份数据库内容
- 配置适当的资源限制，防止资源滥用

## 故障排除

1. 无法连接MySQL：
   - 检查服务是否正常运行
   - 验证用户名和密码是否正确
   - 确认网络连接是否畅通
   - 检查容器日志
2. 持久化问题：
   - 确认PVC已正确创建并绑定
   - 检查存储类是否可用
   - 验证存储容量是否足够 