# Minecraft

官方Minecraft服务器Chart，提供多人在线游戏世界。

## 应用介绍

Minecraft 是一款广受欢迎的沙盒游戏，玩家可以在其中探索、建造、合作与战斗。本 Chart 部署 Minecraft 服务器，为玩家提供多人在线游戏世界，并支持自定义插件、模组和配置，满足社区服务器和私人服务器需求。

本应用提供以下功能：
- 支持多种服务器类型：官方版、Paper、Forge等
- 持久化存储：保存游戏世界和玩家数据
- 可定制配置：通过环境变量调整服务器参数
- 资源管理：可配置CPU和内存限制

## 工作负载类型

此Helm Chart使用 `StatefulSet` 工作负载类型。

- StatefulSet适合有状态应用，提供持久标识和存储，确保游戏数据安全

## 配置说明

| 参数 | 说明 | 默认值 |
|------|------|--------|
| 镜像标签 | Minecraft服务器版本 | `latest` |
| 服务端口 | Minecraft服务器端口 | `25565` |
| 资源限制 | CPU和内存限制 | 见下文 |
| 持久化存储 | 游戏数据存储配置 | 见下文 |

### 资源配置
- CPU限制: 900m（相当于0.9核心）
- 内存限制: 2000Mi（相当于2GB内存）
- CPU请求: 800m（相当于0.8核心）
- 内存请求: 1024Mi（相当于1GB内存）

### 持久化存储配置
- 启用持久化: true（建议开启）
- 挂载路径: /data
- 存储大小: 10Gi（可根据需求调整）
- 存储类: local（取决于集群环境）

### 环境变量配置

| 变量名 | 说明 | 默认值 |
|--------|------|--------|
| EULA | 最终用户许可协议 | `TRUE` |
| TYPE | 服务器类型 | `PAPER` |
| MEMORY | 内存分配 | `1G` |
| ONLINE_MODE | 在线模式 | `FALSE` |
| VERSION | 游戏版本 | `1.20.2` |
| RCON_PASSWORD | 远程控制台密码 | `budiu123` |

## 数据存储

Minecraft游戏数据默认存储在容器的 `/data` 目录中，启用持久化存储后，数据将保存在持久卷中，即使容器重启也不会丢失游戏世界和玩家数据。

**提示**：请确保分配足够的存储空间，根据预期玩家数量和游戏世界大小，可能需要调整存储大小。

## 使用说明

1. 部署应用后，可通过以下方式访问服务：
   - Minecraft客户端：连接到服务器IP地址，端口25565

2. 服务器管理：
   - 使用RCON客户端连接到服务器进行远程管理
   - 通过Kubernetes命令行工具查看日志：
   ```
   kubectl logs -f <pod-name>
   ```

## 安全注意事项

- 生产环境中请修改默认的RCON密码
- 考虑启用正版验证（ONLINE_MODE=TRUE）以增强安全性
- 定期备份游戏世界数据
- 配置适当的资源限制，防止资源滥用

## 故障排除

1. 无法连接服务器：
   - 检查服务是否正常运行
   - 验证网络连接和端口映射
   - 检查容器日志中的错误信息
2. 游戏性能问题：
   - 检查资源使用情况，考虑增加CPU和内存限制
   - 减少游戏世界中的实体数量
   - 调整服务器参数优化性能
3. 持久化问题：
   - 确认PVC已正确创建并绑定
   - 检查存储类是否可用
   - 验证存储容量是否足够